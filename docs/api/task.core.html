<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>task.core documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script><link rel="stylesheet" type="text/css" href="css/kingfisher.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700|Source+Code+Pro" /></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Task</span> <span class="project-version">0.1.0-SNAPSHOT</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Topics</span></h3><ul><li class="depth-1 "><a href="01-overview.html"><div class="inner"><span>Overview</span></div></a></li><li class="depth-1 "><a href="02-guide.html"><div class="inner"><span>User Guide</span></div></a></li><li class="depth-1 "><a href="03-executors.html"><div class="inner"><span>Execution Model</span></div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1 current"><a href="task.core.html"><div class="inner"><span>task.core</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="task.core.html#var-*pool*"><div class="inner"><span>*pool*</span></div></a></li><li class="depth-1"><a href="task.core.html#var-common-pool"><div class="inner"><span>common-pool</span></div></a></li><li class="depth-1"><a href="task.core.html#var-compose"><div class="inner"><span>compose</span></div></a></li><li class="depth-1"><a href="task.core.html#var-compose-in"><div class="inner"><span>compose-in</span></div></a></li><li class="depth-1"><a href="task.core.html#var-failed"><div class="inner"><span>failed</span></div></a></li><li class="depth-1"><a href="task.core.html#var-fn-.3Efuture"><div class="inner"><span>fn-&gt;future</span></div></a></li><li class="depth-1"><a href="task.core.html#var-for"><div class="inner"><span>for</span></div></a></li><li class="depth-1"><a href="task.core.html#var-for-in"><div class="inner"><span>for-in</span></div></a></li><li class="depth-1"><a href="task.core.html#var-future-.3Etask"><div class="inner"><span>future-&gt;task</span></div></a></li><li class="depth-1"><a href="task.core.html#var-now"><div class="inner"><span>now</span></div></a></li><li class="depth-1"><a href="task.core.html#var-run"><div class="inner"><span>run</span></div></a></li><li class="depth-1"><a href="task.core.html#var-run-in"><div class="inner"><span>run-in</span></div></a></li><li class="depth-1"><a href="task.core.html#var-sequence"><div class="inner"><span>sequence</span></div></a></li><li class="depth-1"><a href="task.core.html#var-sequence-in"><div class="inner"><span>sequence-in</span></div></a></li><li class="depth-1"><a href="task.core.html#var-Task"><div class="inner"><span>Task</span></div></a></li><li class="depth-2 branch"><a href="task.core.html#var-cancel"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>cancel</span></div></a></li><li class="depth-2 branch"><a href="task.core.html#var-cancelled.3F"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>cancelled?</span></div></a></li><li class="depth-2 branch"><a href="task.core.html#var-complete.21"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>complete!</span></div></a></li><li class="depth-2 branch"><a href="task.core.html#var-done.3F"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>done?</span></div></a></li><li class="depth-2 branch"><a href="task.core.html#var-else"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>else</span></div></a></li><li class="depth-2 branch"><a href="task.core.html#var-fail.21"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>fail!</span></div></a></li><li class="depth-2 branch"><a href="task.core.html#var-failed.3F"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>failed?</span></div></a></li><li class="depth-2 branch"><a href="task.core.html#var-failure"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>failure</span></div></a></li><li class="depth-2 branch"><a href="task.core.html#var-force.21"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>force!</span></div></a></li><li class="depth-2 branch"><a href="task.core.html#var-recover"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>recover</span></div></a></li><li class="depth-2"><a href="task.core.html#var-task-.3Efuture"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>task-&gt;future</span></div></a></li><li class="depth-1"><a href="task.core.html#var-then"><div class="inner"><span>then</span></div></a></li><li class="depth-1"><a href="task.core.html#var-then-in"><div class="inner"><span>then-in</span></div></a></li><li class="depth-1"><a href="task.core.html#var-traverse"><div class="inner"><span>traverse</span></div></a></li><li class="depth-1"><a href="task.core.html#var-traverse-in"><div class="inner"><span>traverse-in</span></div></a></li><li class="depth-1"><a href="task.core.html#var-void"><div class="inner"><span>void</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">task.core</h1><div class="doc"><div class="markdown"><p>This namespace contains the core components of the task libary.</p>
<p>For task creation, see <a href="task.core.html#var-run">run</a>.</p>
<p>For task combinators, see <a href="task.core.html#var-then">then</a>, <a href="task.core.html#var-compose">compose</a>, <a href="task.core.html#var-for">for</a> and <a href="task.core.html#var-sequence">sequence</a>.</p>
<p>To use custom executors, you have either two options: implicitly via dynamic binding, or explicitly using an additional parameter.</p>
<p>By default, the executor is bound to the variable <a href="task.core.html#var-*pool*">*pool*</a>. This can be re-bound dynamically  like this:</p>
<pre><code class="clojure">(binding [*pool* (Executors/newFixedThreadPool 4)]
  @(then inc (task/run 1234)))
</code></pre>
<p>By default, <code>*pool*</code> is bound to <a href="task.core.html#var-common-pool">common-pool</a>.</p>
<p>Otherwise, you can use the parameter versions. The explicit versions have <code>-in</code> appended to their names.  * <a href="task.core.html#var-run">run</a> and <a href="task.core.html#var-run-in">run-in</a>  * <a href="task.core.html#var-then">then</a> and <a href="task.core.html#var-then-in">then-in</a>  * <a href="task.core.html#var-compose">compose</a> and <a href="task.core.html#var-compose-in">compose-in</a>  * <a href="task.core.html#var-for">for</a> and <a href="task.core.html#var-for-in">for-in</a>  * <a href="task.core.html#var-sequence">sequence</a> and <a href="task.core.html#var-sequence-in">sequence-in</a></p>
<p>For more information see the documentation about the <a href="./03-executors.html">execution model</a>.</p></div></div><div class="public anchor" id="var-*pool*"><h3>*pool*</h3><h4 class="dynamic">dynamic</h4><div class="usage"></div><div class="doc"><div class="markdown"><p>The dynamic binding for the executor. Re-bind this var to set a new executor for that scope. Defaults to <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/ForkJoinPool.html">ForkJoinPool</a>.</p></div></div><div class="src-link"><a href="https://github.com/ane/task/blob/master/src/main/clj/task/core.clj#L104">view source</a></div></div><div class="public anchor" id="var-common-pool"><h3>common-pool</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>An alias for the <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/ForkJoinPool.html">ForkJoinPool</a> Executor.</p></div></div><div class="src-link"><a href="https://github.com/ane/task/blob/master/src/main/clj/task/core.clj#L100">view source</a></div></div><div class="public anchor" id="var-compose"><h3>compose</h3><div class="usage"><code>(compose func)</code><code>(compose func task)</code></div><div class="doc"><div class="markdown"><p>Chain two tasks together. Applies <code>func</code>, which is a function returning a task, to the result of <code>task</code>. This returns a new task.</p>
<p>Should be used when the function to <a href="task.core.html#var-then">then</a> returns a task, which would otherwise result in a task inside a task.</p>
<p>With one argument, create a function that accepts a task. With two args, apply <code>func</code> to <code>task</code> directly.</p>
<p>By default, it uses the executor bound to <a href="task.core.html#var-*pool*">*pool*</a>.</p>
<p>See also <a href="task.core.html#var-compose-in">compose-in</a>.</p></div></div><div class="src-link"><a href="https://github.com/ane/task/blob/master/src/main/clj/task/core.clj#L175">view source</a></div></div><div class="public anchor" id="var-compose-in"><h3>compose-in</h3><div class="usage"><code>(compose-in executor f task)</code></div><div class="doc"><div class="markdown"><p>Like <a href="task.core.html#var-compose">compose</a>, but use the explicit executor given in <code>executor</code>.</p></div></div><div class="src-link"><a href="https://github.com/ane/task/blob/master/src/main/clj/task/core.clj#L168">view source</a></div></div><div class="public anchor" id="var-failed"><h3>failed</h3><div class="usage"><code>(failed t)</code></div><div class="doc"><div class="markdown"><p>Create a new task that fails with <code>t</code>.</p></div></div><div class="src-link"><a href="https://github.com/ane/task/blob/master/src/main/clj/task/core.clj#L247">view source</a></div></div><div class="public anchor" id="var-fn-.3Efuture"><h3>fn-&gt;future</h3><div class="usage"><code>(fn-&gt;future func &amp; [executor])</code></div><div class="doc"><div class="markdown"><p>Convert any function into a CompletableFuture.</p></div></div><div class="src-link"><a href="https://github.com/ane/task/blob/master/src/main/clj/task/core.clj#L114">view source</a></div></div><div class="public anchor" id="var-for"><h3>for</h3><h4 class="type">macro</h4><div class="usage"><code>(for bindings &amp; body)</code></div><div class="doc"><div class="markdown"><p>Chain multiple tasks together. Returns a new task that evaluates when all the tasks are ready together. The task evaluates to <code>body</code>. Uses the executor bound to <a href="task.core.html#var-*pool*">*pool*</a> by default.</p></div></div><div class="src-link"><a href="https://github.com/ane/task/blob/master/src/main/clj/task/core.clj#L209">view source</a></div></div><div class="public anchor" id="var-for-in"><h3>for-in</h3><h4 class="type">macro</h4><div class="usage"><code>(for-in executor bindings &amp; body)</code></div><div class="doc"><div class="markdown"><p>Chain multiple tasks together. Returns a new task that evaluates when all the tasks are ready together. The task evaluates to <code>body</code>. Uses the <code>executor</code> executor.</p></div></div><div class="src-link"><a href="https://github.com/ane/task/blob/master/src/main/clj/task/core.clj#L216">view source</a></div></div><div class="public anchor" id="var-future-.3Etask"><h3>future-&gt;task</h3><div class="usage"><code>(future-&gt;task fut)</code></div><div class="doc"><div class="markdown"><p>Convert a CompletableFuture into a Task.</p></div></div><div class="src-link"><a href="https://github.com/ane/task/blob/master/src/main/clj/task/core.clj#L67">view source</a></div></div><div class="public anchor" id="var-now"><h3>now</h3><div class="usage"><code>(now value)</code></div><div class="doc"><div class="markdown"><p>Create a task that completes immediately with <code>value</code>.</p></div></div><div class="src-link"><a href="https://github.com/ane/task/blob/master/src/main/clj/task/core.clj#L109">view source</a></div></div><div class="public anchor" id="var-run"><h3>run</h3><h4 class="type">macro</h4><div class="usage"><code>(run &amp; body)</code></div><div class="doc"><div class="markdown"><p>Create a task. Runs <code>body</code> according to the execution model. Produces a <a href="task.core.html#var-Task">Task</a> that evaluates to the result of <code>body</code>.</p>
<p>This <em>may</em> mean running in another thread.  The default behaviour is the executor bound to <a href="task.core.html#var-*pool*">*pool*</a> which <code>body</code> inside  the <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/ForkJoinPool.html">ForkJoinPool</a>  executor.</p></div></div><div class="src-link"><a href="https://github.com/ane/task/blob/master/src/main/clj/task/core.clj#L119">view source</a></div></div><div class="public anchor" id="var-run-in"><h3>run-in</h3><h4 class="type">macro</h4><div class="usage"><code>(run-in executor &amp; body)</code></div><div class="doc"><div class="markdown"><p>Execute <code>body</code> inside the supplied <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/ExecutorService.html">ExecutorServce</a>.</p></div></div><div class="src-link"><a href="https://github.com/ane/task/blob/master/src/main/clj/task/core.clj#L129">view source</a></div></div><div class="public anchor" id="var-sequence"><h3>sequence</h3><div class="usage"><code>(sequence tasks)</code></div><div class="doc"><div class="markdown"><p>Turn a sequence of tasks into a task of a sequence. Returns a new task returning a vector of all the results of each task. The task evaluates when all the tasks evaluate.</p>
<p>Rebind <a href="task.core.html#var-*pool*">*pool*</a> to change the executor.</p></div></div><div class="src-link"><a href="https://github.com/ane/task/blob/master/src/main/clj/task/core.clj#L239">view source</a></div></div><div class="public anchor" id="var-sequence-in"><h3>sequence-in</h3><div class="usage"><code>(sequence-in executor tasks)</code></div><div class="doc"><div class="markdown"><p>Like <a href="task.core.html#var-sequence">sequence</a>, but pass explicit <code>executor</code>.</p></div></div><div class="src-link"><a href="https://github.com/ane/task/blob/master/src/main/clj/task/core.clj#L228">view source</a></div></div><div class="public anchor" id="var-Task"><h3>Task</h3><h4 class="type">protocol</h4><div class="usage"></div><div class="doc"><div class="markdown"></div></div><div class="members"><h4>members</h4><div class="inner"><div class="public anchor" id="var-cancel"><h3>cancel</h3><div class="usage"><code>(cancel this)</code></div><div class="doc"><div class="markdown"><p>Attempt to cancel the future, returns true if it cancelled.</p></div></div></div><div class="public anchor" id="var-cancelled.3F"><h3>cancelled?</h3><div class="usage"><code>(cancelled? this)</code></div><div class="doc"><div class="markdown"><p>Was the task cancelled?</p></div></div></div><div class="public anchor" id="var-complete.21"><h3>complete!</h3><div class="usage"><code>(complete! this)</code><code>(complete! this value)</code></div><div class="doc"><div class="markdown"><p>Complete the task with some value if it hasn’t completed already.</p></div></div></div><div class="public anchor" id="var-done.3F"><h3>done?</h3><div class="usage"><code>(done? this)</code></div><div class="doc"><div class="markdown"><p>Has the task completed in any fashion?</p></div></div></div><div class="public anchor" id="var-else"><h3>else</h3><div class="usage"><code>(else this value)</code></div><div class="doc"><div class="markdown"><p>Get the value of the task if it’s complete. Otherwise return <code>value</code>. This is non-blocking.</p></div></div></div><div class="public anchor" id="var-fail.21"><h3>fail!</h3><div class="usage"><code>(fail! this throwable)</code></div><div class="doc"><div class="markdown"><p>Force the task to fail with <code>throwable</code> whether or not already completed.</p></div></div></div><div class="public anchor" id="var-failed.3F"><h3>failed?</h3><div class="usage"><code>(failed? this)</code></div><div class="doc"><div class="markdown"><p>Did the task complete with an exception of any kind?</p></div></div></div><div class="public anchor" id="var-failure"><h3>failure</h3><div class="usage"><code>(failure this)</code></div><div class="doc"><div class="markdown"><p>If the task has completed exceptionally, get the Throwable that produced the exceptional completion.</p></div></div></div><div class="public anchor" id="var-force.21"><h3>force!</h3><div class="usage"><code>(force! this value)</code></div><div class="doc"><div class="markdown"><p>Force the task to return <code>value</code> whether or not already completed.</p></div></div></div><div class="public anchor" id="var-recover"><h3>recover</h3><div class="usage"><code>(recover this f)</code></div><div class="doc"><div class="markdown"><p>Recover possible failures in <code>task</code>. Returns a new task. This task evaluates to two possible values. If the task completes with an exception, this exception is passed to <code>func</code>, and the task evaluates to its result. If the task completes normally, the task will evaluate to that result.</p></div></div></div><div class="public anchor" id="var-task-.3Efuture"><h3>task-&gt;future</h3><div class="usage"><code>(task-&gt;future this)</code></div><div class="doc"><div class="markdown"><p>Convert this task into a CompletableFuture.</p></div></div></div></div></div><div class="src-link"><a href="https://github.com/ane/task/blob/master/src/main/clj/task/core.clj#L49">view source</a></div></div><div class="public anchor" id="var-then"><h3>then</h3><div class="usage"><code>(then func)</code><code>(then func task)</code></div><div class="doc"><div class="markdown"><p>Apply a function to the result of <code>task</code>. Returns a new task.</p>
<p>With one argument, creates a function that accepts a task, and applies <code>func</code> on that task.</p>
<p>With two arguments, applies <code>func</code> to <code>task</code>.</p>
<p>By default, it uses the executor bound to <a href="task.core.html#var-*pool*">*pool*</a>.</p>
<p>See <a href="task.core.html#var-then-in">then-in</a>.</p></div></div><div class="src-link"><a href="https://github.com/ane/task/blob/master/src/main/clj/task/core.clj#L155">view source</a></div></div><div class="public anchor" id="var-then-in"><h3>then-in</h3><div class="usage"><code>(then-in executor f task)</code></div><div class="doc"><div class="markdown"><p>Like <a href="task.core.html#var-then">then</a>, but use the explicit executor given in <code>executor</code>.</p></div></div><div class="src-link"><a href="https://github.com/ane/task/blob/master/src/main/clj/task/core.clj#L149">view source</a></div></div><div class="public anchor" id="var-traverse"><h3>traverse</h3><div class="usage"><code>(traverse xs f)</code></div><div class="doc"><div class="markdown"><p>Map over a sequence with a function that produces a task, and capture the result of the whole operation in a task. Given <code>f</code> which is a function from something to a task, <code>traverse</code> produces a task that evaluates into a list as if f were <code>map</code>d over it.</p></div></div><div class="src-link"><a href="https://github.com/ane/task/blob/master/src/main/clj/task/core.clj#L265">view source</a></div></div><div class="public anchor" id="var-traverse-in"><h3>traverse-in</h3><div class="usage"><code>(traverse-in executor xs f)</code></div><div class="doc"><div class="markdown"><p>Like <a href="task.core.html#var-traverse">traverse</a> but with explicit executor.</p></div></div><div class="src-link"><a href="https://github.com/ane/task/blob/master/src/main/clj/task/core.clj#L254">view source</a></div></div><div class="public anchor" id="var-void"><h3>void</h3><div class="usage"><code>(void)</code></div><div class="doc"><div class="markdown"><p>Create an incomplete task with nothing in it.</p></div></div><div class="src-link"><a href="https://github.com/ane/task/blob/master/src/main/clj/task/core.clj#L223">view source</a></div></div></div></body></html>